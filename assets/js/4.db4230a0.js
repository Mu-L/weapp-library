(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{373:function(t,s,a){t.exports=a.p+"assets/img/swagger_ui_1.c30af27b.png"},374:function(t,s,a){t.exports=a.p+"assets/img/swagger_ui_2.35c20122.png"},375:function(t,s,a){t.exports=a.p+"assets/img/swagger_ui_3.e67088ab.png"},376:function(t,s,a){t.exports=a.p+"assets/img/swagger_ui_4.aa951165.png"},377:function(t,s,a){t.exports=a.p+"assets/img/postman.1a0264ba.png"},390:function(t,s,a){"use strict";a.r(s);var e=a(45),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("访问 "),e("a",{attrs:{href:"https://app.swaggerhub.com/apis/imageslr/weapp/1.0.1#/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Swagger 文档"),e("OutboundLink")],1),t._v("可能需要科学上网")])]),t._v(" "),e("p",[t._v("本项目基于 RESTful 架构风格设计了规范的 API。利用 YAML 语言对接口路径、接口参数、参数约束、返回信息格式等作了详细定义，接口文档发布在"),e("a",{attrs:{href:"https://app.swaggerhub.com/apis/imageslr/weapp/1.0.1#/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Swagger"),e("OutboundLink")],1),t._v("上；通过 Slim 框架实现服务器对 API 的路由。")]),t._v(" "),e("p",[t._v("本项目基于 API 文档实现了开发过程的前后端分离：前后端基于同一个 API 文档开发，前端通过 mock 网站获取假数据，后端利用 PostMan 工具模拟请求测试接口，开发完成后能够很快进行整合，无论是开发效率还是程序的可维护性都大大提高。")]),t._v(" "),e("h2",{attrs:{id:"文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文档"}},[t._v("#")]),t._v(" 文档")]),t._v(" "),e("p",[t._v("本项目利用 YAML 语言对接口路径、接口参数、参数约束、返回信息格式等作了详细定义，接口文档发布在 Swagger 上，Swagger 是一个 REST API 文档生成工具。"),e("a",{attrs:{href:"https://app.swaggerhub.com/apis/imageslr/weapp/1.0.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("点击这里查看文档"),e("OutboundLink")],1),t._v("，文档语法遵循"),e("a",{attrs:{href:"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md",target:"_blank",rel:"noopener noreferrer"}},[t._v(" OpenAPI 规范"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("p",[t._v("以下是对 Swagger 界面的介绍：")]),t._v(" "),e("p",[e("img",{attrs:{src:a(373),alt:"swagger_ui"}})]),t._v(" "),e("p",[e("img",{attrs:{src:a(374),alt:"swagger_ui"}})]),t._v(" "),e("p",[e("img",{attrs:{src:a(375),alt:"swagger_ui"}})]),t._v(" "),e("p",[e("img",{attrs:{src:a(376),alt:"swagger_ui"}})]),t._v(" "),e("h2",{attrs:{id:"约定"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#约定"}},[t._v("#")]),t._v(" 约定")]),t._v(" "),e("h3",{attrs:{id:"url"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#url"}},[t._v("#")]),t._v(" URL")]),t._v(" "),e("ul",[e("li",[t._v("用一级路径表示”资源“，如"),e("code",[t._v("https://api.example.com/users")]),t._v(" 表示全部用户信息")]),t._v(" "),e("li",[t._v("为应对 API 变更的情况，将API的版本号放入URL，如"),e("code",[t._v("https://api.example.com/v1/")])])]),t._v(" "),e("h3",{attrs:{id:"http-动词"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-动词"}},[t._v("#")]),t._v(" HTTP 动词")]),t._v(" "),e("p",[t._v("本项目主要使用以下三种请求方法：")]),t._v(" "),e("ul",[e("li",[t._v("GET（SELECT）：从服务器取出资源（一项或多项）")]),t._v(" "),e("li",[t._v("POST（CREATE/UPDATE）：在服务器新建/修改一个资源")]),t._v(" "),e("li",[t._v("DELETE（DELETE）：从服务器删除资源")])]),t._v(" "),e("h3",{attrs:{id:"参数位置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数位置"}},[t._v("#")]),t._v(" 参数位置")]),t._v(" "),e("ul",[e("li",[t._v("路径"),e("code",[t._v("path")]),t._v("：如"),e("code",[t._v("id")])]),t._v(" "),e("li",[t._v("url"),e("code",[t._v("query")]),t._v("：主要用于"),e("code",[t._v("GET")]),t._v("请求，如"),e("code",[t._v("start")]),t._v("，"),e("code",[t._v("count")])]),t._v(" "),e("li",[t._v("请求体"),e("code",[t._v("body")]),t._v("：主要用于"),e("code",[t._v("POST")]),t._v("请求，如修改个人信息时的提交内容")]),t._v(" "),e("li",[t._v("请求头"),e("code",[t._v("header")]),t._v("：如 "),e("code",[t._v("TOKEN")])])]),t._v(" "),e("h3",{attrs:{id:"数据格式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据格式"}},[t._v("#")]),t._v(" 数据格式")]),t._v(" "),e("ul",[e("li",[t._v("前端向服务器发送的数据、服务器返回的数据均为"),e("code",[t._v("JSON")]),t._v("格式")]),t._v(" "),e("li",[t._v("部分情况下（如上传图片）可以是"),e("code",[t._v("form-data")]),t._v("格式")])]),t._v(" "),e("h3",{attrs:{id:"状态码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#状态码"}},[t._v("#")]),t._v(" 状态码")]),t._v(" "),e("p",[t._v("本项目使用了以下几种状态码表示执行结果：")]),t._v(" "),e("ul",[e("li",[t._v("200：操作成功")]),t._v(" "),e("li",[t._v("201：创建资源成功")]),t._v(" "),e("li",[t._v("400：参数不合法（缺少必要参数或参数格式错误）")]),t._v(" "),e("li",[t._v("401：认证失败：token、用户名、密码错误")]),t._v(" "),e("li",[t._v("403：用户已登录，但是禁止访问")]),t._v(" "),e("li",[t._v("404：资源不存在")]),t._v(" "),e("li",[t._v("500：服务器内部错误")])]),t._v(" "),e("h3",{attrs:{id:"最佳实践"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),e("h4",{attrs:{id:"对一级路径进行-get-请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#对一级路径进行-get-请求"}},[t._v("#")]),t._v(" 对一级路径进行 GET 请求")]),t._v(" "),e("p",[t._v("返回数据资源的数组，如"),e("code",[t._v("GET /reviews")]),t._v("返回多条评论。前端可设置"),e("code",[t._v("start")]),t._v("与"),e("code",[t._v("count")]),t._v("，分别代表数据的偏移与返回数据的个数。")]),t._v(" "),e("p",[t._v("返回值定义如下，其中"),e("strong",[t._v("模型数组的键名命名为对应 "),e("code",[t._v("Model")]),t._v(" 类名的复数")]),t._v("（见"),e("RouterLink",{attrs:{to:"/guide/back.html#数据库与模型类"}},[t._v("数据库与模型类-命名")]),t._v("）：")],1),t._v(" "),e("div",{staticClass:"language-JSON extra-class"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("div",{staticClass:"highlighted"},[t._v(" ")]),e("br"),e("br"),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reviews"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模型数组，对应模型类为 Review")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"start"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 偏移量，默认 0")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"count"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取个数，默认 20")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10297")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据总数")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h4",{attrs:{id:"对一级路径进行-post-请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#对一级路径进行-post-请求"}},[t._v("#")]),t._v(" 对一级路径进行 POST 请求")]),t._v(" "),e("p",[t._v("表示向该资源添加数据，如"),e("code",[t._v("POST /users")]),t._v("表示添加一名用户。")]),t._v(" "),e("h4",{attrs:{id:"对二级路径进行-get-post-delete-请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#对二级路径进行-get-post-delete-请求"}},[t._v("#")]),t._v(" 对二级路径进行 GET/POST/DELETE 请求")]),t._v(" "),e("p",[t._v("表示对一个特定的数据资源进行操作。如"),e("code",[t._v("GET /users/1")]),t._v("返回"),e("code",[t._v("id")]),t._v("为 1 的用户的信息；"),e("code",[t._v("POST /users/1")]),t._v("表示修改"),e("code",[t._v("id")]),t._v("为 1 的用户的信息；"),e("code",[t._v("DELETE /users/1")]),t._v("表示删除"),e("code",[t._v("id")]),t._v("为 1 的用户）")]),t._v(" "),e("h4",{attrs:{id:"其他"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),e("ul",[e("li",[t._v("对于所有POST请求，服务器应返回修改后的数据资源")]),t._v(" "),e("li",[t._v("键名与 Model 类名一致，如"),e("code",[t._v("/collections")]),t._v("的返回值为馆藏对象，包含图书信息和图书馆信息，则其定义为：")])]),t._v(" "),e("div",{staticClass:"language-JSON extra-class"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("div",{staticClass:"highlighted"},[t._v(" ")]),e("div",{staticClass:"highlighted"},[t._v(" ")]),e("br"),e("br"),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"book"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 图书信息，对应 Model 类为 Book")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"library"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 图书馆信息，对应 Model 类为 Library")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"available_num"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"total_num"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10297")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"错误对象"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#错误对象"}},[t._v("#")]),t._v(" 错误对象")]),t._v(" "),e("p",[t._v("对于所有状态码 ≥ 400 的错误响应，均返回一个错误对象，包含三个属性：错误码、给开发者看的错误信息和给用户看的错误信息。")]),t._v(" "),e("div",{staticClass:"language-JSON extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Integer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 自定义错误码")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"message"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// message for user 显示给用户的错误信息")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"err_msg"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// message for developer 显示给开发者的错误信息")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"测试工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#测试工具"}},[t._v("#")]),t._v(" 测试工具")]),t._v(" "),e("p",[t._v("PostMan")]),t._v(" "),e("p",[e("img",{attrs:{src:a(377),alt:"postman"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);